<!-- 如你所见 这是模板 -->
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="/css/pagestyle.css">
    <link rel="stylesheet" type="text/css" href="/css/bilibili-style.css">
    <style>
        /* 新增投票样式 */
        .vote-container {
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            margin: 10px;
        }
        .vote-option {
            margin: 10px 0;
            padding: 12px;
            background: rgba(0,0,0,0.3);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .vote-option:hover {
            background: rgba(0,0,0,0.5);
        }
        .results-bar {
            height: 20px;
            background: #555;
            border-radius: 10px;
            margin: 5px 0;
            overflow: hidden;
        }
        .results-fill {
            height: 100%;
            background: #00a1d6;
            transition: width 0.5s;
        }
        #timer {
            color: #ff9f43;
            font-weight: bold;
            font-size: 1.2em;
        }
    </style>
    <meta name="description" content="网页介绍, 给浏览器看的">
    <meta name="keywords" content="搜索关键词">
    <meta name="author" content="作者">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <title>2025狂欢节活动</title>
</head>
<body>
    <div class="header">
        <h1>QB红石VisualNovel</h1>
    </div>
    <div class="container">
        <div class="content">
            <div class="nav list">
                <!-- 直播区块保持不变 -->
                <ul>
                    <div class="block">
                        <div class="bilibili-iframe" style="height: 100%;">
                            <iframe class="bilibili" style="height: 90%;width: 95%"
                                src="https://www.bilibili.com/blackboard/live/live-activity-player.html?cid=1856393864&quality=0"
                                scrolling="no" frameborder="no" allowfullscreen="true"
                                sandbox="allow-top-navigation allow-same-origin allow-forms allow-scripts allow-popups"
                                width="100%" height="80%">
                            </iframe>
                            <script src="/js/bilibili.js"></script>
                        </div>
                    </div>
                </ul>

                <!-- 替换原始按钮部分为投票系统 -->
                <ul>
                    <div class="block">
                        <div class="vote-container">
                            <h2 id="voteQuestion">您希望下次活动在哪里举办？</h2>
                            <div id="voteOptions">
                                <div class="vote-option" onclick="castVote('A')">大礼堂</div>
                                <div class="vote-option" onclick="castVote('B')">体育馆</div>
                                <div class="vote-option" onclick="castVote('C')">操场</div>
                            </div>
                            <div id="voteTimer">
                                剩余时间: <span id="timer">05:00</span>
                            </div>
                            <div id="voteResults" style="display:none;">
                                <h3>投票结果</h3>
                                <div id="resultsContainer"></div>
                            </div>
                        </div>
                    </div>
                </ul>

                <!-- 文案区块保持不变 -->
                <ul>
                    <div class="block">
                        <div class="introduce">
                            文案区
                            这对吗, 对的对的
                            <br><br>
                            大家好啊，这里是QB红石VisualNovel的先行宣传。在狂欢节当天，我们将会为大家呈现一个大型，多人协同的视觉小说活动。现在，每个人都有机会成为活动的贡献者。
                            <br><br>
                            在故事进行中，玩家有机会触发彩蛋，从而获得一定的奖品，为了使得奖品足够有吸引力以及有趣，我们接受奖品赞助。你可以提供任何物品/承诺(*)，我们会将其与彩蛋绑定，于狂欢节时公布。
                            <br><br>
                            作为支持我们的回报，对于每一位赞助者，我们可以为您提供以下权益：<br>
                            1. 您的名字将会被记录在贡献者名单上，与活动一同展出<br>
                            2. 加入赞助者群，参与活动内测<br>
                            3. 在故事中加入您设想的情节(*)<br>
                            4. 在活动期间的qb我的世界校园服务器获得特殊头衔<br>
                            <br>
                            公平起见，赞助者不会被告知彩蛋触发方式相关的信息。
                            <br>
                            活动筹划方：红石设计社，学生电视台，程序设计社，推理社
                            联系人<br>
                            qq：1073171253，wx：w20071203zhizhi<br>
                            (*)内容符合一般高中生形象, 解释权归筹划方所有<br>
                        </div>
                    </div>
                </ul>
            </div>
        </div>

        <!-- 侧边栏保持不变 -->
        <div class="sidebar">
            <p>维护者:zhizhizhiwang、Gcint、FuriousC</p>
            <p>最后修改日期:<span data-file="/carnival/home.html"></span></p>
            <script src="/js/getUpdate.js"></script>
            <p><img src="这里填一个page view badge" /></p>
            <a href=""><p>查看成就</p></a>
            <a href="/home.html"><p>回到主页</p></a>
            <a href="/download.html"><p>下载链接汇总</p></a>
        </div>
    </div>

    <!-- 投票系统脚本 -->
    <script>
        // 投票系统逻辑
        let voteEndTime = localStorage.getItem('voteEndTime') || (Date.now() + 300000);
        let votes = JSON.parse(localStorage.getItem('votes')) || { A: 0, B: 0, C: 0 };
        let hasVoted = localStorage.getItem('hasVoted') === 'true';

        function updateTimer() {
            const now = Date.now();
            const diff = voteEndTime - now;
            
            if (diff <= 0) {
                showResults();
                return;
            }

            const minutes = Math.floor(diff / 60000);
            const seconds = Math.floor((diff % 60000) / 1000);
            document.getElementById('timer').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function castVote(option) {
            if (hasVoted) return alert('您已经投过票了！');
            if (!confirm(`确认选择 ${option} 选项吗？`)) return;
            
            votes[option]++;
            localStorage.setItem('votes', JSON.stringify(votes));
            localStorage.setItem('hasVoted', 'true');
            hasVoted = true;
            alert('投票成功！');
        }

        function showResults() {
            document.getElementById('voteOptions').style.display = 'none';
            document.getElementById('voteTimer').style.display = 'none';
            document.getElementById('voteResults').style.display = 'block';

            const total = Object.values(votes).reduce((a, b) => a + b, 0);
            const container = document.getElementById('resultsContainer');
            container.innerHTML = '';

            for (const [option, count] of Object.entries(votes)) {
                const percent = total === 0 ? 0 : Math.round((count / total) * 100);
                container.innerHTML += `
                    <div>${option}选项：${count}票 (${percent}%)</div>
                    <div class="results-bar">
                        <div class="results-fill" style="width: ${percent}%"></div>
                    </div>
                `;
            }
        }

        // 初始化定时器
        setInterval(updateTimer, 1000);
        updateTimer();
        if (Date.now() > voteEndTime) showResults();
        if (hasVoted) document.getElementById('voteOptions').innerHTML = '<p>感谢您的参与！</p>';

        // 管理员功能
        window.setNewVote = (options, duration) => {
            localStorage.clear();
            votes = Object.fromEntries(options.map(opt => [opt, 0]));
            voteEndTime = Date.now() + duration * 60000;
            localStorage.setItem('votes', JSON.stringify(votes));
            localStorage.setItem('voteEndTime', voteEndTime);
            location.reload();
        }
    </script>

    <!-- 页脚保持不变 -->
    <div class="footer copyleft" id="footer">
        <p>本作品采用 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。</p>
        <p>
            <a href="https://github.com/zhizhizhiwang/RedStoneHub">
                <svg aria-hidden="true" focusable="false" viewBox="0 0 24 24" width="32" height="32" fill="currentColor"
                    style="display:inline-block;user-select:none;vertical-align:text-bottom;overflow:visible">
                    <path d="M12.5.75C6.146.75 1 5.896 1 12.25c0 5.089 3.292 9.387 7.863 10.91.575.101.79-.244.79-.546 0-.273-.014-1.178-.014-2.142-2.889.532-3.636-.704-3.866-1.35-.13-.331-.69-1.352-1.18-1.625-.402-.216-.977-.748-.014-.762.906-.014 1.553.834 1.769 1.179 1.035 1.74 2.688 1.25 3.349.948.1-.747.402-1.25.733-1.538-2.559-.287-5.232-1.279-5.232-5.678 0-1.25.445-2.285 1.178-3.09-.115-.288-.517-1.467.115-3.048 0 0 .963-.302 3.163 1.179.92-.259 1.897-.388 2.875-.388.977 0 1.955.13 2.875.388 2.2-1.495 3.162-1.179 3.162-1.179.633 1.581.23 2.76.115 3.048.733.805 1.179 1.825 1.179 3.09 0 4.413-2.688 5.39-5.247 5.678.417.36.776 1.05.776 2.128 0 1.538-.014 2.774-.014 3.162 0 .302.216.662.79.547C20.709 21.637 24 17.324 24 12.25 24 5.896 18.854.75 12.5.75Z"/>
                </svg>
                <span>当前构建版本: </span>
                <span version=""></span>
            </a>
            <script src="/js/getVersion.js"></script>
        </p>
    </div>
</body>
</html>